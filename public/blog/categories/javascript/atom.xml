<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: JavaScript | Joel Hooks]]></title>
  <link href="http://joelhooks.com/blog/categories/javascript/atom.xml" rel="self"/>
  <link href="http://joelhooks.com/"/>
  <updated>2018-10-20T08:30:26-07:00</updated>
  <id>http://joelhooks.com/</id>
  <author>
    <name><![CDATA[Joel Hooks]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[AngularJS Directives That Override Standard HTML Tags]]></title>
    <link href="http://joelhooks.com/blog/2013/07/15/a-look-at-angularjs-internal-directives-that-override-standard-html-tags/"/>
    <updated>2013-07-15T13:22:00-07:00</updated>
    <id>http://joelhooks.com/blog/2013/07/15/a-look-at-angularjs-internal-directives-that-override-standard-html-tags</id>
    <content type="html"><![CDATA[<p>Directives are the heart and soul of AngularJS. They are incredibly powerful.
AngularJS sets out to extend the grammar of the browser to supply semantics that
facilitate the creation of web applications, going beyond the standard
hyper-linked web page. The primary weapon to accomplish this is the directive.</p>

<p>Creating your own directives is an awesome way to create composed, reusable
behaviors in your applications. This article isn&rsquo;t about making your own
directives, instead I wanted to take a closer look at the internal directives of
AngularJS. Specifically, we will be looking at how and why AngularJS extends the
functionality of native HTML tags like <code>&lt;input&gt;</code> and <code>&lt;a&gt;</code> to make the magic
happen.</p>

<h2>A is for Anchor</h2>

<p>``` javascript
var htmlAnchorDirective = valueFn({
  restrict: &lsquo;E&rsquo;,
  compile: function(element, attr) {</p>

<pre><code>if (msie &lt;= 8) {

  // turn &lt;a href ng-click=".."&gt;link&lt;/a&gt; into a stylable link in IE
  // but only if it doesn't have name attribute, in which case it's an anchor
  if (!attr.href &amp;&amp; !attr.name) {
    attr.$set('href', '');
  }

  // add a comment node to anchors to workaround IE bug that causes element content to be reset
  // to new attribute content if attribute is updated with value containing @ and element also
  // contains value with @
  // see issue #1949
  element.append(document.createComment('IE fix'));
}

return function(scope, element) {
  element.on('click', function(event){
    // if we have no href url, then don't navigate anywhere.
    if (!element.attr('href')) {
      event.preventDefault();
    }
  });
}
</code></pre>

<p>  }
});
```</p>

<p>The <a href="https://github.com/angular/angular.js/blob/master/src/ng/directive/a.js"><code>htmlAnchorDirective</code></a> has a simple job. It is there to prevent navigation and page reloading. Typically this is in conjunction with <code>ng-click</code>, which is used to actually capture the click and navigate the user within the application. Every <code>&lt;a&gt;</code> in your application is effectively extended by AngularJS. The functionality is primarily the <code>event.preventDefault()</code> that is applied if the anchor tag doesn&rsquo;t have an <code>href</code> attribute.</p>

<p>One thing to note, and this is typical throughout the AngularJS internals, is that this directive requires special attention for IE 7. When I&rsquo;m digging around in the internals, I&rsquo;m always appreciative of this effort made by the AngularJS contributors. These aren&rsquo;t fun problems to solve, and it is nice that somebody has made the effort to solve them for us :></p>

<h2>Digging into &lt;form></h2>

<p><a href="https://github.com/angular/angular.js/blob/master/src/ng/directive/form.js">AngularJS overrides <code>&lt;form&gt;</code></a> to provide some important functionality. The core of this extension of <code>&lt;form&gt;</code> is to prevent any page refresh that would occur with an unmodified <code>&lt;form&gt;</code> tag. Lets have a look:</p>

<p>``` javascript
var formDirectiveFactory = function(isNgForm) {
  return [&lsquo;$timeout&rsquo;, function($timeout) {</p>

<pre><code>var formDirective = {
  name: 'form',
  restrict: 'E',
  controller: FormController,
  compile: function() {
    return {
      pre: function(scope, formElement, attr, controller) {
        if (!attr.action) {
          // we can't use jq events because if a form is destroyed during submission the default
          // action is not prevented. see #1238
          //
          // IE 9 is not affected because it doesn't fire a submit event and try to do a full
          // page reload if the form was destroyed by submission of the form via a click handler
          // on a button in the form. Looks like an IE9 specific bug.
          var preventDefaultListener = function(event) {
            event.preventDefault
              ? event.preventDefault()
              : event.returnValue = false; // IE
          };

          addEventListenerFn(formElement[0], 'submit', preventDefaultListener);

          // unregister the preventDefault listener so that we don't not leak memory but in a
          // way that will achieve the prevention of the default action.
          formElement.on('$destroy', function() {
            $timeout(function() {
              removeEventListenerFn(formElement[0], 'submit', preventDefaultListener);
            }, 0, false);
          });
        }

        var parentFormCtrl = formElement.parent().controller('form'),
            alias = attr.name || attr.ngForm;

        if (alias) {
          scope[alias] = controller;
        }
        if (parentFormCtrl) {
          formElement.on('$destroy', function() {
            parentFormCtrl.$removeControl(controller);
            if (alias) {
              scope[alias] = undefined;
            }
            extend(controller, nullFormCtrl); //stop propagating child destruction handlers upwards
          });
        }
      }
    };
  }
};

return isNgForm ? extend(copy(formDirective), {restrict: 'EAC'}) : formDirective;
</code></pre>

<p>  }];
};
```</p>

<p>The above function is a factory that creates a form directive. The directive itself does several things. Aside from some memory management it also serves to prevent the default behavior of the form action. Typically with an AngularJS application, you will want to capture the user&rsquo;s input it a form, and feed that data into a controller to send it to the server. This is different from the standard <code>action</code> attribute of a form that will perform a POST operation and typically redirect the user to a new page. This behavior is probably not what you want in your single-page JavaScript application, so AngularJS is working to help prevent that. You probably still want to be able to submit your form, and the <code>ngSubmit</code> directive placed as an attribute on the <code>&lt;form&gt;</code> tag will execute an expression when your designated submit input is clicked.</p>

<p>If you&rsquo;re paying close attention, you&rsquo;ll notice that the form directive above has a <code>FormController</code> assigned to it. The <code>FormController</code> is the brains of all the forms within an AngularJS application, and every <code>&lt;form&gt;</code> gets one. The <code>FormController</code> tracks all of the controls within a form and manages the validity of the form.</p>

<h2>The Input Directive</h2>

<p>``` javascript
var inputDirective = [&lsquo;$browser&rsquo;, &lsquo;$sniffer&rsquo;, function($browser, $sniffer) {
  return {</p>

<pre><code>restrict: 'E',
require: '?ngModel',
link: function(scope, element, attr, ctrl) {
  if (ctrl) {
    (inputType[lowercase(attr.type)] || inputType.text)(scope, element, attr, ctrl, $sniffer,
                                                        $browser);
  }
}
</code></pre>

<p>  };
}];
```</p>

<p>Wow! It&rsquo;s so simple ;)</p>

<p>It is. This is because <a href="https://github.com/angular/angular.js/blob/master/src/ng/directive/input.js">the actual <code>&lt;input&gt;</code> tag</a> is only the entry point. The real work is done based on the <strong>type</strong> of input that is being used. AngularJS is looking for the following input types:</p>

<ul>
<li>text</li>
<li>number</li>
<li>url</li>
<li>email</li>
<li>radio</li>
<li>checkbox</li>
</ul>


<p>With the URL, email, and number types, AngularJS provides some basic validation:</p>

<p><code>javascript
var URL_REGEXP = /^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&amp;%@!\-\/]))?$/;
var EMAIL_REGEXP = /^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,4}$/;
var NUMBER_REGEXP = /^\s*(\-|\+)?(\d+|(\d*(\.\d*)))\s*$/;
</code></p>

<p>Here&rsquo;s the code for the URL type:</p>

<p>``` javascript
function urlInputType(scope, element, attr, ctrl, $sniffer, $browser) {
  textInputType(scope, element, attr, ctrl, $sniffer, $browser);</p>

<p>  var urlValidator = function(value) {</p>

<pre><code>if (isEmpty(value) || URL_REGEXP.test(value)) {
  ctrl.$setValidity('url', true);
  return value;
} else {
  ctrl.$setValidity('url', false);
  return undefined;
}
</code></pre>

<p>  };</p>

<p>  ctrl.$formatters.push(urlValidator);
  ctrl.$parsers.push(urlValidator);
}
```</p>

<p>Simple stuff. It is using the REGEX above and setting the validity on the <code>FormController</code>, which you can then use to display feedback to the user. Email and number validation works in a similar fashion.</p>

<p>With text-type inputs AnglularJS also provides <strong>data-binding</strong> via <code>ngModel</code>, which is an extremely convenient solution to capturing user input and displaying it in the form. We should look at <code>ngModel</code> a bit closer in a future post.</p>

<h2>Just the beginning.</h2>

<p>It wasn&rsquo;t immediately obvious to me when I started using AngularJS that the framework was overriding these default HTML tags to add the secret sauce on top. Once the realization dawned on me, it opened my eyes to the power and potential that directives hold. You aren&rsquo;t restricted to the extensions that AngularJS provides with these built-in directives. You can further extend the capabilities of HTML by creating your own directives that override and extend the native HTML elements.</p>

<p>Digging into the guts of the <a href="https://github.com/angular/angular.js/tree/master/src">AngularJS source code</a> is a great way to learn the hows and whys of the framework, and can reveal techniques that can be applied to your own applications. The AngularJS source is well documented, cleanly written, and well tested. If you&rsquo;re working with AngularJS, I highly recommend diving into these internals and discovering this for yourself. It won&rsquo;t be time wasted.</p>

<p>You might also enjoy: <a href="http://joelhooks.com/blog/2013/05/22/lessons-learned-kicking-off-an-angularjs-project/"><strong>Lessons Learned: A Year with a Large AngularJS Project</strong></a></p>

<p>or maybe: <a href="http://joelhooks.com/blog/2013/08/03/learn-angularjs-in-a-weekend/"><strong>Learn AngularJS this Weekend</strong></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[On Transitioning to JavaScript From AS3/Flex]]></title>
    <link href="http://joelhooks.com/blog/2012/08/27/on-transitioning-to-javascript-from-as3-slash-flex/"/>
    <updated>2012-08-27T10:12:00-07:00</updated>
    <id>http://joelhooks.com/blog/2012/08/27/on-transitioning-to-javascript-from-as3-slash-flex</id>
    <content type="html"><![CDATA[<p>I&rsquo;m currently working on a large enterprise JS application, and enjoying myself quite a bit. We&rsquo;ve implemented standards and practices that remove most of the bad parts of JS dev. We are using straight up JS with <a href="http://www.angularjs.org/">AngularJS</a>. We are covering our important logic with solid unit tests. We are responding to client requests for features in an agile fashion. The code base is something that could (and will) be documented and passed along to future developers for maintenance.</p>

<p>I read a good book recently, <a href="http://www.amazon.com/exec/obidos/ASIN/1591843162/joehoobuiblo-20/ref=nosim/">Linchpin by Seth Godin</a>, which helped me adjust my mindset quite a bit. Enterprise consulting can be frustrating. The concept of finding the challenges, embracing them, and truly enjoying what I am doing now has been a boost to my overall psyche. I suffered mightily when the <a href="http://blogs.adobe.com/flex/2011/11/your-questions-about-flex.html">November shit-storm</a> hit the fan. Devpression. In May, I had the opportunity to take a long term Flex position, or this long term JS gig. Despite the heavy reading I did on the subject, I had a strong case of the <a href="http://en.wikipedia.org/wiki/Impostor_syndrome">&ldquo;Impostor Syndrome&rdquo;</a>. It took a bit to catch my stride, but now I am fully confident that rigorously developed enterprise JS can (and does) exist.</p>

<p>The &ldquo;bad parts&rdquo; of JS dev, to me, is just &ldquo;same shit; different pile.&rdquo; The biggest problems that I face are wet works issues. Human systems. Training, mentoring, and facilitating. How do I, as the &ldquo;architect,&rdquo; (I deplore this term, but for lack of a better term right now&hellip;) tee my devs up for success. Where do we need to be rigidly disciplined in our development, and where can we just run with it? How do we consistently hit that sweet spot in the enterprise software development Venn diagram?</p>

<p><img src="/images/dev-venn.png" alt="Sweet Spot in Software Development" /></p>

<p>I would have a much harder time with the transition if I couldn&rsquo;t have a firm grip on the rudder, or if I was stuck in an environment that had no will for high quality code. That is what I am looking for. I don&rsquo;t really care about platform/language (<em>this is only half true, I care, it just isn&rsquo;t at the top of the list</em>). I am interested in an org that is dedicated to pushing the quality envelope top to bottom. What I want to do is stand on the shoulders of giants, across languages, platforms and disciplines, with an amalgamation of techniques and practices that fit together to create something greater than its parts. I&rsquo;m not looking to change the world, but rather looking to deliver high quality and provide for my family with a healthy work:life balance.</p>

<p>How are you dealing with the transition?</p>
]]></content>
  </entry>
  
</feed>
